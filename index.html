<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tegra - Technical Spec Manager</title>
  
  <!-- ESTILOS -->
  <link rel="stylesheet" href="styles.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  
  <!-- LIBRER칈AS EXTERNAS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  
  <!-- ========== CONFIGURACIONES ========== -->
  <script src="js/config/config.js"></script>           <!-- Configuraci칩n unificada -->
  <script src="js/config/config-teams.js"></script>     <!-- Equipos -->
  <script src="js/config/config-logos.js"></script>     <!-- Logos -->
  
  <!-- ========== M칍DULOS CARGADOS EN INDEX.HTML (IMPORTANTE) ========== -->
  <!-- Estos se cargan aqu칤 porque main.js los necesita disponibles inmediatamente -->
  <script src="js/modules/ui/theme-manager.js"></script>
  <script src="js/modules/ui/dashboard-manager.js"></script>
  <script src="js/modules/ui/tabs-manager.js"></script>
  <script src="js/modules/data/storage-manager.js"></script>
<script src="js/modules/data/client-data-manager.js"></script> <!-- Renombrado -->
<script src="js/modules/data/specs-data-manager.js"></script> <!-- Renombrado -->

  <!-- ========== ENTRADA PRINCIPAL (칔LTIMO) ========== -->
  <!-- main.js cargar치 los dem치s m칩dulos (utils, core, placements, export) -->
  <script src="js/main.js"></script>
</head>
<body>
  <div class="app-container">
      <!-- HEADER -->
      <header class="app-header">
          <div class="logo-section">
              <div class="app-logo">
                  <!-- SVG logo aqu칤 -->
                  <svg viewBox="0 0 145.94 39.05">
                      <path fill="#ffffff" d="M42.24,12.37v1.93h6.91v15.25h4.21v-15.25h6.91v-3.88h-16.1l-1.93,1.95ZM92.06,20.31v1.87h4.24v2.73c-.53.38-1.13.67-1.8.86-.67.19-1.39.29-2.16.29-.84,0-1.61.15-2.32-.45-.71-.3-1.33-.72-1.84-1.27-.52-.55-.92-1.19-1.2-1.93-.28-.74-.42-1.54-.42-2.42v-.05c0-.82.14-1.59.42-2.31.28-.72.67-1.35,1.18-1.89.5-.54,1.08-.97,1.75-1.28.66-.32,1.38-.48,2.15-.48.55,0,1.05.05,1.5.14.46.09.88.22,1.27.38.39.16.77.36,1.13.60.25.16.49.34.74.54l2.94-2.97c-.47-.4-.96-.75-1.46-1.07-.53-.33-1.09-.60-1.70-.82-.60-.22-1.25-.39-1.95-.51-.70-.12-1.48-.18-2.34-.18-1.44,0-2.77.26-4,.78-1.23.52-2.29,1.23-3.18,2.13-.89.90-1.59,1.95-2.09,3.14-.50,1.19-.75,2.47-.75,3.84v-.05c0,1.42.25,2.73.74,3.94.49,1.20,1.18,2.24,2.06,3.12.88.87,1.94,1.56,3.17,2.05,1.23.49,2.59.74,4.09.74,1.75,0,3.30-.30,4.66-.89,1.36-.59,2.53-1.31,3.51-2.15v-8.31h-6.56l-1.74,1.76ZM68.15,21.8h9.02v-3.74h-9.02v-3.88h10.25v-3.74h-12.55l0.14,0.14v17.12h14.54v-3.74h-10.53v-4.02ZM114.24,10.43h-8.75v19.13h4.21v-6.12h3.31l4.10,6.12h2.57l1.39-1.40-3.71-5.43c1.22-.46,2.21-1.17,2.97-2.15.76-.97,1.13-2.24,1.13-3.79v-.05c0-1.82-.55-3.28-1.64-4.37-1.29-1.29-3.15-1.94-5.58-1.94ZM117.19,17.03c0,.82-.28,1.48-.83,1.98-.56.49-1.35.74-2.39.74h-4.26v-5.52h4.18c1.04,0,1.85.23,2.43.69.58.46.87,1.14.87,2.06v-.05ZM136.7,10.29h-3.88l-8.20,19.27h4.29l1.75-4.29h8.09l1.75,4.29h1.97l1.70-1.72-7.47-17.55ZM132.16,21.58l2.54-6.20,2.54,6.20h-5.08Z"/>
                      <g fill="#ffffff">
                          <polygon points="7.44 31.38 6.59 32.24 6.88 33.39 8.03 33.68 8.89 32.83 8.59 31.68 7.44 31.38"/>
                          <polygon points="6.79 28.67 7.94 28.97 10.41 26.5 10.11 25.35 8.96 25.05 6.49 27.52 6.79 28.67"/>
                          <polygon points="10.54 14.61 9.4 14.31 6.93 16.78 7.23 17.93 8.37 18.23 10.85 15.76 10.54 14.61"/>
                          <polygon points="26.38 22.79 25.06 24.11 25.36 25.26 26.5 25.56 27.82 24.24 27.52 23.09 26.38 22.79"/>
                      </g>
                  </svg>
              </div>
              <div>
                  <h1 class="app-title">Technical Spec Manager</h1>
                  <p class="app-subtitle">Sistema de gesti칩n de especificaciones t칠cnicas</p>
              </div>
              <div class="theme-toggle">
                  <button id="themeToggle" class="theme-toggle-btn">
                      <i class="fas fa-sun"></i> Modo Claro
                  </button>
              </div>
          </div>

          <div class="client-section">
              <span class="client-label">CUSTOMER / CLIENTE:</span>
              <input type="text" id="customer" class="form-control" placeholder="Nombre del cliente" style="width: 180px; margin: 0 10px;">
              <div class="client-logo-wrapper">
                  <img id="logoCliente" alt="Logo del cliente" style="max-height: 35px; max-width: 120px; display: none;">
              </div>
          </div>

          <div class="header-actions">
              <div class="folder-input-container">
                  <span class="client-label" style="font-size: 0.9rem; color: White;"># FOLDER:</span>
                  <input type="text" id="folder-num" class="form-control" placeholder="#####">
              </div>
              <div id="current-datetime"></div>
          </div>
      </header>

      <!-- NAVIGATION -->
      <nav class="app-nav no-print">
          <ul class="nav-tabs">
              <li class="nav-tab active" data-tab="dashboard">
                  <i class="fas fa-tachometer-alt"></i> Dashboard
              </li>
              <li class="nav-tab" data-tab="spec-creator">
                  <i class="fas fa-file-alt"></i> Crear Spec
              </li>
              <li class="nav-tab" data-tab="saved-specs">
                  <i class="fas fa-database"></i> Guardadas
              </li>
              <li class="nav-tab" data-tab="error-log">
                  <i class="fas fa-exclamation-triangle"></i> Log de Errores
              </li>
          </ul>
      </nav>

      <!-- MAIN CONTENT -->
      <main class="app-main">
          <!-- PESTA칌A DASHBOARD -->
          <div class="tab-content active" id="dashboard">
              <div class="dashboard-grid">
                  <!-- Se llena din치micamente por DashboardManager -->
              </div>
              
              <!-- 칔ltimas specs -->
              <div class="card" style="margin-top: 20px;">
                  <div class="card-header">
                      <h2 class="card-title"><i class="fas fa-history"></i> Actividad Reciente</h2>
                  </div>
                  <div class="card-body">
                      <div id="recent-activity">
                          <p style="color: var(--text-secondary); text-align: center; padding: 20px;">
                              <i class="fas fa-spinner fa-spin"></i> Cargando actividad...
                          </p>
                      </div>
                  </div>
              </div>
          </div>
          
          <!-- PESTA칌A CREAR SPEC -->
          <div class="tab-content" id="spec-creator">
              <div class="card">
                  <div class="card-header">
                      <h2 class="card-title"><i class="fas fa-plus-circle"></i> Crear Nueva Especificaci칩n</h2>
                  </div>
                  <div class="card-body">
                      <!-- FORMULARIO B츼SICO -->
                      <div class="form-grid" style="margin-bottom: 30px;">
                          <div class="form-group">
                              <label class="form-label">STYLE # / PO #</label>
                              <input type="text" id="style" class="form-control" placeholder="Ej: UM9110-PMD0">
                          </div>
                          
                          <div class="form-group">
                              <label class="form-label">TEAM / EQUIPO</label>
                              <input type="text" id="name-team" class="form-control" placeholder="Se autodetecta del style">
                          </div>
                          
                          <div class="form-group">
                              <label class="form-label">GENDER / G칄NERO</label>
                              <input type="text" id="gender" class="form-control" placeholder="Se autodetecta del style">
                          </div>
                          
                          <div class="form-group">
                              <label class="form-label">SEASON / TEMPORADA</label>
                              <select id="season" class="form-control">
                                  <option value="">Seleccionar...</option>
                                  <option value="SS24">SS24</option>
                                  <option value="FW24">FW24</option>
                                  <option value="SS25">SS25</option>
                                  <option value="FW25">FW25</option>
                              </select>
                          </div>
                          
                          <div class="form-group">
                              <label class="form-label">DESIGNER / DISE칌ADOR</label>
                              <select id="designer" class="form-control">
                                  <option value="">Seleccionar...</option>
                                  <option value="ELMER VELEZ">ELMER VELEZ</option>
                                  <option value="DANIEL HERNANDEZ">DANIEL HERNANDEZ</option>
                                  <option value="CINDY PINEDA">CINDY PINEDA</option>
                                  <option value="OTRO">OTRO</option>
                              </select>
                          </div>
                          
                          <div class="form-group">
                              <label class="form-label">INK TYPE / TIPO DE TINTA</label>
                              <select id="ink-type" class="form-control">
                                  <option value="WATER">WATER</option>
                                  <option value="PLASTISOL">PLASTISOL</option>
                                  <option value="SILICONE">SILICONE</option>
                              </select>
                          </div>
                      </div>
                      
                      <!-- CONTENEDOR PRINCIPAL PARA PLACEMENTS -->
                      <div id="placements-container">
                          <!-- Se llena din치micamente por PlacementsUI -->
                          <p style="color: var(--text-secondary); text-align: center; padding: 40px;">
                              <i class="fas fa-spinner fa-spin"></i> Inicializando editor de placements...
                          </p>
                      </div>
                      
                      <!-- PESTA칌AS DE PLACEMENTS -->
                      <div id="placements-tabs-container" class="placement-tabs">
                          <!-- Se llena din치micamente por PlacementsUI -->
                      </div>
                      
                      <!-- BOTONES DE ACCI칍N -->
                      <div style="display: flex; gap: 10px; margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-dark);">
                          <button id="add-placement-btn" class="btn btn-primary">
                              <i class="fas fa-plus"></i> Agregar Placement
                          </button>
                          <button id="save-spec-btn" class="btn btn-success">
                              <i class="fas fa-save"></i> Guardar Spec
                          </button>
                          <button id="export-pdf-btn" class="btn btn-warning">
                              <i class="fas fa-file-pdf"></i> Exportar PDF
                          </button>
                          <button id="export-excel-btn" class="btn btn-primary">
                              <i class="fas fa-file-excel"></i> Exportar Excel
                          </button>
                          <button id="export-zip-btn" class="btn btn-info">
                              <i class="fas fa-file-archive"></i> Exportar ZIP
                          </button>
                      </div>
                  </div>
              </div>
          </div>
          
          <!-- PESTA칌A GUARDADAS -->
          <div class="tab-content" id="saved-specs">
              <div class="card">
                  <div class="card-header">
                      <h2 class="card-title"><i class="fas fa-database"></i> Especificaciones Guardadas</h2>
                      <div style="display: flex; gap: 10px;">
                          <button id="refresh-specs-btn" class="btn btn-sm btn-white-base">
                              <i class="fas fa-sync-alt"></i> Actualizar
                          </button>
                          <button id="import-spec-btn" class="btn btn-sm btn-white-base">
                              <i class="fas fa-upload"></i> Importar
                          </button>
                          <button id="export-all-btn" class="btn btn-sm btn-white-base">
                              <i class="fas fa-download"></i> Exportar Todo
                          </button>
                      </div>
                  </div>
                  <div class="card-body">
                      <!-- FILTROS -->
                      <div style="display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap;">
                          <input type="text" id="filter-specs" class="form-control" placeholder="Buscar por cliente, style, equipo..." style="flex: 1; min-width: 250px;">
                          <select id="filter-status" class="form-control" style="width: 150px;">
                              <option value="">Todos los estados</option>
                              <option value="draft">Borrador</option>
                              <option value="completed">Completado</option>
                              <option value="archived">Archivado</option>
                          </select>
                          <select id="filter-season" class="form-control" style="width: 120px;">
                              <option value="">Todas temporadas</option>
                              <option value="SS24">SS24</option>
                              <option value="FW24">FW24</option>
                              <option value="SS25">SS25</option>
                          </select>
                      </div>
                      
                      <!-- LISTA DE SPECS -->
                      <div id="saved-specs-list">
                          <p style="color: var(--text-secondary); text-align: center; padding: 40px;">
                              <i class="fas fa-spinner fa-spin"></i> Cargando especificaciones...
                          </p>
                      </div>
                  </div>
              </div>
          </div>
          
          <!-- PESTA칌A ERROR LOG -->
          <div class="tab-content" id="error-log">
              <div class="card">
                  <div class="card-header">
                      <h2 class="card-title"><i class="fas fa-exclamation-triangle"></i> Log de Errores</h2>
                      <div style="display: flex; gap: 10px;">
                          <button id="clear-errors-btn" class="btn btn-sm btn-danger">
                              <i class="fas fa-trash"></i> Limpiar Todo
                          </button>
                          <button id="export-errors-btn" class="btn btn-sm btn-white-base">
                              <i class="fas fa-download"></i> Exportar Log
                          </button>
                      </div>
                  </div>
                  <div class="card-body">
                      <div id="error-log-list">
                          <!-- Se llena din치micamente por ErrorHandler -->
                          <p style="color: var(--text-secondary); text-align: center; padding: 20px;">
                              No hay errores registrados.
                          </p>
                      </div>
                  </div>
              </div>
          </div>
      </main>

      <!-- LOGOS FOOTER -->
      <div class="logos-container">
          <div style="display: flex; align-items: center; gap: 30px;">
              <div style="font-size: 0.8rem; color: var(--text-secondary);">
                  <div><strong>Tegra Spec Manager</strong> v1.5.0</div>
                  <div>춸 2024 VelezTegra. Todos los derechos reservados.</div>
              </div>
              <div style="display: flex; gap: 40px; align-items: center;">
                  <!-- Logo Tegra -->
                  <svg width="120" height="30" viewBox="0 0 145.94 39.05">
                      <path fill="currentColor" d="M42.24,12.37v1.93h6.91v15.25h4.21v-15.25h6.91v-3.88h-16.1l-1.93,1.95ZM92.06,20.31v1.87h4.24v2.73c-.53.38-1.13.67-1.8.86-.67.19-1.39.29-2.16.29-.84,0-1.61.15-2.32-.45-.71-.3-1.33-.72-1.84-1.27-.52-.55-.92-1.19-1.2-1.93-.28-.74-.42-1.54-.42-2.42v-.05c0-.82.14-1.59.42-2.31.28-.72.67-1.35,1.18-1.89.5-.54,1.08-.97,1.75-1.28.66-.32,1.38-.48,2.15-.48.55,0,1.05.05,1.5.14.46.09.88.22,1.27.38.39.16.77.36,1.13.60.25.16.49.34.74.54l2.94-2.97c-.47-.4-.96-.75-1.46-1.07-.53-.33-1.09-.60-1.70-.82-.60-.22-1.25-.39-1.95-.51-.70-.12-1.48-.18-2.34-.18-1.44,0-2.77.26-4,.78-1.23.52-2.29,1.23-3.18,2.13-.89.90-1.59,1.95-2.09,3.14-.50,1.19-.75,2.47-.75,3.84v-.05c0,1.42.25,2.73.74,3.94.49,1.20,1.18,2.24,2.06,3.12.88.87,1.94,1.56,3.17,2.05,1.23.49,2.59.74,4.09.74,1.75,0,3.30-.30,4.66-.89,1.36-.59,2.53-1.31,3.51-2.15v-8.31h-6.56l-1.74,1.76ZM68.15,21.8h9.02v-3.74h-9.02v-3.88h10.25v-3.74h-12.55l0.14,0.14v17.12h14.54v-3.74h-10.53v-4.02ZM114.24,10.43h-8.75v19.13h4.21v-6.12h3.31l4.10,6.12h2.57l1.39-1.40-3.71-5.43c1.22-.46,2.21-1.17,2.97-2.15.76-.97,1.13-2.24,1.13-3.79v-.05c0-1.82-.55-3.28-1.64-4.37-1.29-1.29-3.15-1.94-5.58-1.94ZM117.19,17.03c0,.82-.28,1.48-.83,1.98-.56.49-1.35.74-2.39.74h-4.26v-5.52h4.18c1.04,0,1.85.23,2.43.69.58.46.87,1.14.87,2.06v-.05ZM136.7,10.29h-3.88l-8.20,19.27h4.29l1.75-4.29h8.09l1.75,4.29h1.97l1.70-1.72-7.47-17.55ZM132.16,21.58l2.54-6.20,2.54,6.20h-5.08Z"/>
                  </svg>
                  
                  <!-- Espacio para otros logos din치micos -->
                  <div id="partner-logos" style="display: flex; gap: 20px; align-items: center;">
                      <!-- Se llenar치 din치micamente con logos de clientes -->
                  </div>
              </div>
          </div>
      </div>

      <!-- STATUS MESSAGE -->
      <div id="statusMessage" class="status-message"></div>
  </div>

  <!-- INPUTS OCULTOS -->
  <input type="file" id="excelFile" accept=".xlsx, .xls, .json, .zip" style="display: none;">
  <input type="file" id="imageInput" accept="image/*" style="display: none;">
  <input type="file" id="placementImageInput" accept="image/*" style="display: none;">
  <input type="file" id="importSpecFile" accept=".json" style="display: none;">

  <!-- SCRIPT PARA CONFIGURAR EVENT LISTENERS B츼SICOS -->
  <script>
  // Configuraci칩n b치sica que se ejecuta inmediatamente
  document.addEventListener('DOMContentLoaded', function() {
      console.log('游늯 DOM completamente cargado');
      
      // Configurar botones b치sicos
      const refreshSpecsBtn = document.getElementById('refresh-specs-btn');
      if (refreshSpecsBtn) {
          refreshSpecsBtn.addEventListener('click', function() {
              if (window.SpecsManager && window.SpecsManager.updateSavedSpecsList) {
                  window.SpecsManager.updateSavedSpecsList();
                  showTempMessage('Lista de specs actualizada', 'success');
              }
          });
      }
      
      // Bot칩n para limpiar errores
      const clearErrorsBtn = document.getElementById('clear-errors-btn');
      if (clearErrorsBtn) {
          clearErrorsBtn.addEventListener('click', function() {
              if (window.ErrorHandler && window.ErrorHandler.clear) {
                  window.ErrorHandler.clear();
                  showTempMessage('Log de errores limpiado', 'success');
              }
          });
      }
      
      // Bot칩n de importar spec
      const importSpecBtn = document.getElementById('import-spec-btn');
      const importSpecFile = document.getElementById('importSpecFile');
      if (importSpecBtn && importSpecFile) {
          importSpecBtn.addEventListener('click', function() {
              importSpecFile.click();
          });
          
          importSpecFile.addEventListener('change', function(e) {
              const file = e.target.files[0];
              if (file && window.SpecsManager && window.SpecsManager.importSpecFromJSON) {
                  const reader = new FileReader();
                  reader.onload = function(event) {
                      try {
                          const specId = window.SpecsManager.importSpecFromJSON(event.target.result);
                          showTempMessage(`Spec importada correctamente (ID: ${specId})`, 'success');
                      } catch (error) {
                          showTempMessage(`Error al importar: ${error.message}`, 'error');
                      }
                  };
                  reader.readAsText(file);
              }
          });
      }
      
      // Funci칩n para mostrar mensajes temporales
      function showTempMessage(message, type = 'info') {
          const statusEl = document.getElementById('statusMessage');
          if (statusEl) {
              statusEl.textContent = message;
              statusEl.className = `status-message status-${type}`;
              statusEl.style.display = 'block';
              
              setTimeout(() => {
                  statusEl.style.display = 'none';
              }, 3000);
          }
      }
  });
  </script>
</body>
</html>
